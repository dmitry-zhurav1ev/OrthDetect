## Описание модели

Модель предназначена для обработки снимков зубов и выявления возможных проблем, таких как промежутки между зубами, скучивание и отсутствие зубов. Эти проблемы выбраны, поскольку их можно легко определить визуально без дополнительных обследований у ортодонта.

## Классы и аннотация данных

- **Healthy (здоровые зубы)**: Он нам необходим для того, чтобы модель имела контекст для сравнения. Модель должна понимать, что считается нормальным расположением зубов, чтобы отличать это от отклонений. Без этого класса она может путать проблемные зубы с нормально расположенными. Для аннотации выбирались 2 и более подряд стоящих здоровых зубов, что позволяет модели усваивать их взаимное расположение. 

- **Gap (промежуток)**: Этот класс выделяет промежутки между зубами. Аннотации включают сами промежутки и небольшую область вокруг них, что помогает модели лучше понимать проблему, так как выделенные области существенно отличаются от других классов.

- **Crowding (скучивание)**: Класс скученных зубов. Определяется как смещение и повороты 1 и более зубов. Как и в случае класса Healthy, зубы аннотировались по парам или группами, поскольку важно учитывать их взаимное расположение для точной детекции проблемы.

- **Missing (отсутствие зуба)**: Подразумевает отсутствие зуба, что проявляется в виде большого промежутка между соседними зубами. Аннотации фиксируют промежуток и зубы, которые он разделяет, что позволяет модели лучше осознавать контекст проблемы.

## Проблемы балансировки классов
В датасете классы имеют следующее распределение по количеству аннотаций:
Healthy - 100; Gap - 116; Crowding - 132; Missing - 44
В нашем случае проблему может представлять класс _**Healthy**_, так как по сути этот класс нам нужен только для обучения, но не для детекции. Зачастую модель никак не определяет этот класс, то есть определяет его как фон. Это приводит к увеличению _false negative_ предсказаний и уменьшению метрики recall. Возможным решением может быть расширение датасета путем аугментации или поиска новых данных.

Класс Missing недопредставлен в нашем датасете, но это не так сильно сказывается на его метриках, так как он хорошо различим от других классов. Очевидно, чтобы улучшить ситуацию, понадобится расширить данные. 

Также изначально у нас был класс "Mild Crowding", который означал слабое смещение 1 зуба, но из-за недостатка данных по этому классу, сложности аннотирования и определения моделью, он часто определялся либо как фон или Crowding (false negative), либо он перекрывал собой Crowding (false positive), что снижало нам recall и prescision соответственно, поэтому мы решили объединить этот класс с Crowding, что положительно сказалось на метриках (рост на 0.1-0.2).

## Используемый датасет

Наш датасет состоит из 195 фотографий: 150 для тренировки и 45 для валидации. Фотографии были отобраны из различных источников, включая сайт [roboflow.com](https://roboflow.com) и обычный поиск изображений в Google. Разметка производилась вручную с использованием онлайн-инструмента makesense.ai.

## Использование инструмента разметки makesense.ai

1. Перейдите на сайт: [makesense.ai](https://makesense.ai).
2. Нажмите на кнопку **Get started**.
3. В открывшемся окне выберите изображения, которые хотите аннотировать, кликнув по прямоугольнику в центре, или перетащите файлы с помощью функции Drag'n'Drop. Если хотите просмотреть используемый датасет, то выберите фотографии из проекта в папке **dataset_teeth** и внутри папок **train** и **val** выберите **images**. Также можно просмотреть весь датасет без деления на **train** и **val**, то можете перейти на [Google Drive](https://drive.google.com/drive/folders/1V4Ac5tm1_94Mqqv4stVo-h5rYWhV-RgZ?usp=drive_link), где хранится наш датасет.
4. Выберите **Object Detection** для разметки объектов на изображениях. 
5. В открывшемся окне создайте метки, которые будут использоваться в вашем проекте. Чтобы загрузить уже существующие метки, подготовьте и загрузите текстовый файл (txt), в котором каждая метка указана с новой строки. Для данной модели используйте файл **labels.txt** из _dataset_teeth/labels.txt_.
6. Для импорта аннотаций в используемый датасет выберите в верхнем меню **Actions** -> **Import Annotations**. Для загрузки аннотаций по нашему датасету в появившемся окне выберите текстовые файлы из папки **labels** на [Google Drive](https://drive.google.com/drive/folders/1yu-aUE0kDHncVNZI8yT96v5T27rfHMKI?usp=drive_link). Вместе с аннотациями к изображениям также необходимо загрузить файл **labels.txt** для сопоставления меток.

## Запуск

1. Запустите файл GUI_predict.py
2. Нажмите кнопку **Загрузить изображение**. Можете выбрать собственные фотографии или фотографии из **test_images**.
3. Смотрите на результат)
